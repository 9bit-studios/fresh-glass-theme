/* ========================================
   MOBILE SPACING OPTIMIZATIONS
   Apple HIG Compliant Mobile Spacing Fixes
   ======================================== */

/* ========================================
   IMPROVED MOBILE SPACING SCALE
   ======================================== */

/* Reduce mobile spacing scale more aggressively for better mobile UX */
@media screen and (max-width: 749px) {
  :root {
    /* More aggressive mobile spacing reduction */
    --spacing-scale-md: 0.5;
    
    /* Apple HIG compliant minimum spacing values */
    --mobile-section-spacing-xs: 8px;
    --mobile-section-spacing-sm: 16px;
    --mobile-section-spacing-md: 24px;
    --mobile-section-spacing-lg: 32px;
    --mobile-section-spacing-xl: 40px;
    
    /* Touch target minimums */
    --mobile-touch-target-min: 44px;
    --mobile-button-spacing: 16px;
    --mobile-text-spacing: 12px;
  }
}

/* ========================================
   PRODUCT PAGE MOBILE OPTIMIZATIONS
   ======================================== */

@media screen and (max-width: 749px) {
  /* Reduce top padding between breadcrumbs and product area by 120px */
  .product-information.section {
    --padding-block-start: max(8px, calc(var(--padding-block-start, 0px) - 120px)) !important;
  }
  
  /* If no explicit padding set, use minimal default */
  .product-information.section:not([style*="padding-block-start"]) {
    padding-block-start: var(--mobile-section-spacing-sm) !important;
  }
  
  /* Reduce spacing between price and add to cart by 40px */
  .product-details .price-wrapper {
    margin-bottom: var(--mobile-text-spacing) !important;
  }
  
  .product-details .product-form {
    margin-top: calc(var(--mobile-button-spacing) - 40px) !important;
    margin-top: max(4px, calc(var(--mobile-button-spacing) - 40px)) !important;
  }
  
  /* Optimize product details internal spacing */
  .product-details > * + * {
    margin-top: var(--mobile-text-spacing) !important;
  }
  
  .product-details .product-form__buttons {
    margin-top: var(--mobile-button-spacing) !important;
  }
}

/* ========================================
   COLLECTIONS PAGE MOBILE OPTIMIZATIONS
   ======================================== */

@media screen and (max-width: 749px) {
  /* Reduce padding between facets filter and collection header by 30px */
  .collection-wrapper .facets-block-wrapper + .main-collection-grid,
  .collection-wrapper .glass-filter-bar + .main-collection-grid,
  .main-collection-grid {
    margin-top: calc(var(--mobile-section-spacing-sm) - 30px) !important;
    margin-top: max(4px, calc(var(--mobile-section-spacing-sm) - 30px)) !important;
  }
  
  /* Optimize collection header spacing */
  .collection-wrapper .collection-header {
    margin-bottom: var(--mobile-section-spacing-sm) !important;
  }
  
  /* Reduce overall collection section padding */
  .main-collection.section,
  .product-grid-container.section {
    --padding-block-start: var(--mobile-section-spacing-sm) !important;
    --padding-block-end: var(--mobile-section-spacing-md) !important;
  }
}

/* ========================================
   SEARCH PAGE MOBILE OPTIMIZATIONS
   ======================================== */

@media screen and (max-width: 749px) {
  /* Reduce padding between facets filter and search field by 60px */
  .search-results .facets-block-wrapper + .search-content,
  .search-results .glass-filter-bar + .search-content,
  .search-content {
    margin-top: calc(var(--mobile-section-spacing-md) - 60px) !important;
    margin-top: max(4px, calc(var(--mobile-section-spacing-md) - 60px)) !important;
  }
  
  /* Optimize search header spacing */
  .search-header {
    padding-block: var(--mobile-section-spacing-sm) !important;
    margin-bottom: var(--mobile-text-spacing) !important;
  }
  
  /* Reduce search section padding */
  .search-results.section {
    --padding-block-start: var(--mobile-section-spacing-sm) !important;
    --padding-block-end: var(--mobile-section-spacing-md) !important;
  }
  
  /* Search input optimization */
  .search-input-wrapper {
    margin-bottom: var(--mobile-section-spacing-sm) !important;
  }
}

/* ========================================
   FILTER & FACETS MOBILE OPTIMIZATIONS
   ======================================== */

@media screen and (max-width: 749px) {
  /* Glass filter bar mobile spacing */
  .glass-filter-bar.section {
    --padding-block-start: var(--mobile-section-spacing-xs) !important;
    --padding-block-end: var(--mobile-section-spacing-xs) !important;
    margin-bottom: 0 !important;
  }
  
  /* Facets block wrapper spacing */
  .facets-block-wrapper {
    margin-bottom: var(--mobile-section-spacing-sm) !important;
  }
  
  /* Filter drawer mobile optimization */
  .facets-drawer {
    padding: var(--mobile-section-spacing-md) !important;
  }
  
  .facets-drawer .facets-header {
    margin-bottom: var(--mobile-section-spacing-md) !important;
  }
}

/* ========================================
   SECTION SPACING OVERRIDES FOR BUILDER FLEXIBILITY
   ======================================== */

/* Allow sections to override mobile spacing with custom properties */
@media screen and (max-width: 749px) {
  .section[data-mobile-spacing-override] {
    --padding-block-start: var(--mobile-spacing-top, var(--mobile-section-spacing-sm)) !important;
    --padding-block-end: var(--mobile-spacing-bottom, var(--mobile-section-spacing-md)) !important;
  }
  
  /* Utility classes for common mobile spacing adjustments */
  .mobile-spacing-tight {
    --padding-block-start: var(--mobile-section-spacing-xs) !important;
    --padding-block-end: var(--mobile-section-spacing-xs) !important;
  }
  
  .mobile-spacing-normal {
    --padding-block-start: var(--mobile-section-spacing-sm) !important;
    --padding-block-end: var(--mobile-section-spacing-md) !important;
  }
  
  .mobile-spacing-loose {
    --padding-block-start: var(--mobile-section-spacing-md) !important;
    --padding-block-end: var(--mobile-section-spacing-xl) !important;
  }
  
  .mobile-spacing-none {
    --padding-block-start: 0px !important;
    --padding-block-end: 0px !important;
  }
}

/* ========================================
   DESKTOP SPACING ADJUSTMENTS
   ======================================== */

@media screen and (min-width: 750px) {
  /* Proportional desktop reductions (smaller values than mobile) */
  .product-information.section {
    --padding-block-start: max(16px, calc(var(--padding-block-start, 0px) - 60px)) !important;
  }
  
  .main-collection.section .collection-wrapper .main-collection-grid {
    margin-top: calc(var(--gap, 16px) - 15px) !important;
    margin-top: max(8px, calc(var(--gap, 16px) - 15px)) !important;
  }
  
  .search-results .search-content {
    margin-top: calc(var(--gap, 24px) - 30px) !important;
    margin-top: max(12px, calc(var(--gap, 24px) - 30px)) !important;
  }
}

/* ========================================
   BUILDER FLEXIBILITY RESTORATION
   ======================================== */

/* Add data attributes to sections for easy builder customization */
.section[data-custom-mobile-spacing="true"] {
  /* Disable automatic spacing optimizations */
}

.section[data-custom-mobile-spacing="true"] * {
  /* Allow manual mobile spacing through inline styles */
}

/* Utility classes that can be toggled in the theme editor */
.section.builder-spacing-auto {
  /* Use optimized spacing (default) */
}

.section.builder-spacing-manual {
  /* Disable optimizations, use manual values */
}

.section.builder-spacing-manual * {
  /* Preserve manual spacing values */
}

/* ========================================
   APPLE HIG COMPLIANCE ENSURES
   ======================================== */

@media screen and (max-width: 749px) {
  /* Ensure minimum touch targets */
  .button,
  .add-to-cart-button,
  .facets-button,
  .filter-button,
  [role="button"] {
    min-height: var(--mobile-touch-target-min) !important;
    min-width: var(--mobile-touch-target-min) !important;
  }
  
  /* Ensure adequate spacing between interactive elements */
  .button + .button,
  .add-to-cart-button + .button,
  .product-form__buttons > * + * {
    margin-top: var(--mobile-button-spacing) !important;
  }
  
  /* Text readability spacing */
  .product-details h1,
  .product-details .price,
  .collection-header h1,
  .search-header h1 {
    margin-bottom: var(--mobile-text-spacing) !important;
    line-height: 1.3 !important;
  }
  
  /* Ensure minimum content margins */
  .section-content,
  .product-details,
  .collection-content,
  .search-content {
    padding-left: max(16px, var(--padding-inline-start, 16px)) !important;
    padding-right: max(16px, var(--padding-inline-end, 16px)) !important;
  }
}

/* ========================================
   RESPONSIVE BREAKPOINT OPTIMIZATIONS
   ======================================== */

/* Tablet landscape optimization */
@media screen and (min-width: 750px) and (max-width: 989px) {
  :root {
    --spacing-scale-md: 0.8;
  }
  
  .product-information.section {
    --padding-block-start: max(12px, calc(var(--padding-block-start, 0px) - 80px)) !important;
  }
}

/* Large desktop optimization */
@media screen and (min-width: 1200px) {
  .section {
    --spacing-scale: 1.1;
  }
}