{%- comment -%}
  Petersen Games - Enhanced Blog Hero Section
  Sophisticated blog header with categories, tags, and engagement features
  Designed for storytelling with video support and smooth transitions
{%- endcomment -%}

<div class="petersen-blog-hero" id="section-{{ section.id }}">
  <div class="blog-hero-container">
    {%- comment -%} Article Meta Information {%- endcomment -%}
    <div class="article-meta">
      {%- if article.tags.size > 0 -%}
        <div class="article-tags">
          {%- for tag in article.tags limit: 3 -%}
            <a href="{{ blog.url }}/tagged/{{ tag | handle }}" class="tag-pill">
              <img src="https://cdn.shopify.com/s/files/1/0701/0277/8037/files/1-05.svg?v=1757991638" alt="" class="tag-glyph">
              {{ tag }}
            </a>
          {%- endfor -%}
        </div>
      {%- endif -%}

      <div class="article-info">
        <time class="article-date" datetime="{{ article.published_at | date: '%Y-%m-%d' }}">
          {{ article.published_at | date: '%B %d, %Y' }}
        </time>
        {%- if article.author != blank -%}
          <span class="article-separator">•</span>
          <span class="article-author">by {{ article.author }}</span>
        {%- endif -%}
        <span class="article-separator">•</span>
        <span class="read-time" data-content="{{ article.content | strip_html | truncatewords: 200 }}">
          <img src="https://cdn.shopify.com/s/files/1/0701/0277/8037/files/1-04.svg?v=1757991638" alt="" class="read-icon">
          <span class="read-time-text">5 min read</span>
        </span>
      </div>
    </div>

    {%- comment -%} Hero Title with Animation {%- endcomment -%}
    <div class="hero-title-wrapper">
      <h1 class="article-title">{{ article.title }}</h1>
      {%- if article.excerpt != blank -%}
        <p class="article-excerpt">{{ article.excerpt | strip_html | truncatewords: 30 }}</p>
      {%- endif -%}
    </div>

    {%- comment -%} Featured Media with Advanced Support {%- endcomment -%}
    {%- if section.settings.show_featured_media -%}
      <div class="hero-media-wrapper">
        {%- if section.settings.hero_video_url != blank -%}
          {%- comment -%} Video Hero {%- endcomment -%}
          <div class="hero-video">
            <div class="video-container">
              <iframe
                src="{{ section.settings.hero_video_url }}"
                title="{{ article.title }} - Featured Video"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen
                loading="lazy">
              </iframe>
            </div>
            <div class="video-overlay">
              <button class="play-button" aria-label="Play video">
                <img src="https://cdn.shopify.com/s/files/1/0701/0277/8037/files/1-08.svg?v=1757991638" alt="" class="play-icon">
              </button>
            </div>
          </div>
        {%- elsif article.image != blank -%}
          {%- comment -%} Image Hero with Parallax Effect {%- endcomment -%}
          <div class="hero-image parallax-container">
            <img
              src="{{ article.image | img_url: '1200x600' }}"
              alt="{{ article.image.alt | default: article.title }}"
              class="featured-image parallax-element"
              loading="lazy"
            >
            <div class="image-overlay"></div>
          </div>
        {%- endif -%}
      </div>
    {%- endif -%}

    {%- comment -%} Engagement Indicators {%- endcomment -%}
    <div class="engagement-bar">
      <div class="engagement-stats">
        {%- if blog.comments_enabled? and article.comments_count > 0 -%}
          <a href="#blog-comments" class="engagement-item comments-link">
            <img src="https://cdn.shopify.com/s/files/1/0701/0277/8037/files/1-03.svg?v=1757991638" alt="" class="engagement-icon">
            <span>{{ article.comments_count }} comment{{ article.comments_count | pluralize: '', 's' }}</span>
          </a>
        {%- endif -%}

        <div class="engagement-item share-trigger" data-article-url="{{ shop.url }}{{ article.url }}">
          <img src="https://cdn.shopify.com/s/files/1/0701/0277/8037/files/1-07.svg?v=1757991638" alt="" class="engagement-icon">
          <span>Share Article</span>
        </div>
      </div>

      {%- comment -%} Category Navigation {%- endcomment -%}
      <div class="category-navigation">
        <a href="{{ blog.url }}" class="category-link">
          <img src="https://cdn.shopify.com/s/files/1/0701/0277/8037/files/1-02.svg?v=1757991638" alt="" class="category-icon">
          {{ blog.title }}
        </a>
        {%- if section.settings.show_related_categories -%}
          {%- assign related_blogs = blogs | where: 'id', blog.id -%}
          {%- for other_blog in blogs limit: 3 -%}
            {%- unless other_blog.id == blog.id -%}
              <a href="{{ other_blog.url }}" class="category-link related">{{ other_blog.title }}</a>
            {%- endunless -%}
          {%- endfor -%}
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

<style>
.petersen-blog-hero {
  margin: {{ section.settings.margin_top }}px 0 {{ section.settings.margin_bottom }}px 0;
  background: transparent;
  overflow: hidden;
}

.blog-hero-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 24px;
  overflow: hidden;
  font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
}

/* Article Meta */
.article-meta {
  padding: 32px 40px 24px 40px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.article-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-bottom: 16px;
}

.tag-pill {
  display: flex;
  align-items: center;
  gap: 6px;
  background: rgba(102, 126, 234, 0.2);
  color: #667eea;
  padding: 8px 16px;
  border-radius: 20px;
  text-decoration: none;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid rgba(102, 126, 234, 0.3);
}

.tag-pill:hover {
  background: rgba(102, 126, 234, 0.3);
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
}

.tag-glyph {
  width: 14px;
  height: 14px;
  filter: brightness(0) invert(1);
  opacity: 0.8;
}

.article-info {
  display: flex;
  align-items: center;
  gap: 16px;
  flex-wrap: wrap;
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.article-date, .article-author {
  font-weight: 500;
}

.article-separator {
  color: rgba(255, 255, 255, 0.4);
}

.read-time {
  display: flex;
  align-items: center;
  gap: 6px;
}

.read-icon {
  width: 14px;
  height: 14px;
  filter: invert(1) brightness(0.8);
}

/* Hero Title */
.hero-title-wrapper {
  padding: 40px 40px 32px 40px;
  text-align: center;
}

.article-title {
  font-size: 2.5rem;
  font-weight: 700;
  color: white;
  margin: 0 0 24px 0;
  letter-spacing: -0.02em;
  line-height: 1.2;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 2px 12px rgba(0, 0, 0, 0.7), 0 0 25px rgba(255, 255, 255, 0.12);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.article-excerpt {
  font-size: 18px;
  color: rgba(255, 255, 255, 0.9);
  line-height: 1.6;
  margin: 0;
  max-width: 600px;
  margin: 0 auto;
  text-shadow: 0 1px 6px rgba(0, 0, 0, 0.4), 0 0 15px rgba(255, 255, 255, 0.08);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.2s both;
}

/* Hero Media */
.hero-media-wrapper {
  position: relative;
  margin: 0 40px 32px 40px;
  border-radius: 16px;
  overflow: hidden;
  animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.4s both;
}

.hero-video, .hero-image {
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 9;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 16px;
  overflow: hidden;
}

.video-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.video-container iframe {
  width: 100%;
  height: 100%;
  border: none;
}

.video-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  cursor: pointer;
}

.video-overlay:hover {
  background: rgba(0, 0, 0, 0.5);
}

.play-button {
  width: 80px;
  height: 80px;
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
}

.play-button:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: scale(1.1);
}

.play-icon {
  width: 32px;
  height: 32px;
  filter: invert(1);
  margin-left: 4px;
}

.parallax-container {
  position: relative;
  overflow: hidden;
}

.featured-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.6s ease-out;
}

.parallax-container:hover .featured-image {
  transform: scale(1.05);
}

.image-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.3) 100%);
  pointer-events: none;
}

/* Engagement Bar */
.engagement-bar {
  padding: 24px 40px 32px 40px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.6s both;
}

.engagement-stats {
  display: flex;
  gap: 32px;
}

.engagement-item {
  display: flex;
  align-items: center;
  gap: 8px;
  color: rgba(255, 255, 255, 0.8);
  text-decoration: none;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.engagement-item:hover {
  color: #667eea;
  transform: translateY(-2px);
}

.engagement-icon {
  width: 16px;
  height: 16px;
  filter: invert(1) brightness(0.8);
  transition: all 0.2s ease;
}

.engagement-item:hover .engagement-icon {
  filter: brightness(0) invert(1);
  transform: scale(1.1);
}

.category-navigation {
  display: flex;
  gap: 20px;
  align-items: center;
}

.category-link {
  display: flex;
  align-items: center;
  gap: 6px;
  color: rgba(255, 255, 255, 0.8);
  text-decoration: none;
  font-size: 14px;
  font-weight: 500;
  padding: 8px 16px;
  border-radius: 20px;
  transition: all 0.3s ease;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.category-link:hover {
  background: rgba(255, 255, 255, 0.1);
  color: white;
  transform: translateY(-2px);
}

.category-link.related {
  opacity: 0.7;
  font-size: 13px;
}

.category-icon {
  width: 14px;
  height: 14px;
  filter: invert(1) brightness(0.8);
}

/* Animations */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
  .blog-hero-container {
    border-radius: 16px;
  }

  .article-meta,
  .hero-title-wrapper,
  .hero-media-wrapper,
  .engagement-bar {
    padding-left: 24px;
    padding-right: 24px;
  }

  .hero-media-wrapper {
    margin-left: 24px;
    margin-right: 24px;
  }

  .article-title {
    font-size: 2rem;
  }

  .article-excerpt {
    font-size: 16px;
  }

  .engagement-bar {
    flex-direction: column;
    gap: 20px;
    align-items: flex-start;
  }

  .category-navigation {
    flex-wrap: wrap;
    gap: 12px;
  }

  .article-tags {
    justify-content: center;
  }
}

@media (max-width: 480px) {
  .article-info {
    justify-content: center;
    text-align: center;
  }

  .engagement-stats {
    flex-direction: column;
    gap: 16px;
    align-items: center;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Calculate read time
  const readTimeElement = document.querySelector('.read-time-text');
  const content = document.querySelector('[data-content]');

  if (readTimeElement && content) {
    const text = content.getAttribute('data-content');
    const wordsPerMinute = 200;
    const wordCount = text.split(' ').length;
    const readTime = Math.ceil(wordCount / wordsPerMinute);
    readTimeElement.textContent = `${readTime} min read`;
  }

  // Video overlay click handler
  const videoOverlay = document.querySelector('.video-overlay');
  if (videoOverlay) {
    videoOverlay.addEventListener('click', function() {
      this.style.display = 'none';
    });
  }

  // Parallax effect
  const parallaxElements = document.querySelectorAll('.parallax-element');
  if (parallaxElements.length > 0) {
    window.addEventListener('scroll', function() {
      const scrolled = window.pageYOffset;
      parallaxElements.forEach(element => {
        const rate = scrolled * -0.3;
        element.style.transform = `translateY(${rate}px)`;
      });
    });
  }

  // Share functionality
  const shareTriggger = document.querySelector('.share-trigger');
  if (shareTriggger) {
    shareTriggger.addEventListener('click', function() {
      const url = this.getAttribute('data-article-url');
      if (navigator.share) {
        navigator.share({
          title: document.title,
          url: url
        });
      } else {
        navigator.clipboard.writeText(url);
        // Could add toast notification here
      }
    });
  }
});
</script>

{% schema %}
{
  "name": "Enhanced Blog Hero",
  "tag": "section",
  "class": "petersen-blog-hero-section",
  "settings": [
    {
      "type": "header",
      "content": "Media Settings"
    },
    {
      "type": "checkbox",
      "id": "show_featured_media",
      "label": "Show featured media",
      "default": true
    },
    {
      "type": "url",
      "id": "hero_video_url",
      "label": "Hero video URL (YouTube/Vimeo)",
      "info": "If provided, this will override the featured image"
    },
    {
      "type": "header",
      "content": "Navigation Settings"
    },
    {
      "type": "checkbox",
      "id": "show_related_categories",
      "label": "Show related blog categories",
      "default": true
    },
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Top margin",
      "default": 40
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Bottom margin",
      "default": 40
    }
  ],
  "presets": [
    {
      "name": "Enhanced Blog Hero",
      "settings": {
        "show_featured_media": true,
        "show_related_categories": true
      }
    }
  ]
}
{% endschema %}